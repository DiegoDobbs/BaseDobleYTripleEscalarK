prime:=6277101735386680763835789423207666416083908700390324961279;
// prime es un primo de 512 bits de nivel de seguridad NIST.
print "prime = ", prime;
F := FiniteField(prime) ; //Definiendo un cuerpo finito |p|_2=192
a:=F!(-3);
b:=F!(0x64210519e59c80e70fa7e9ab72243049feb8deecc146b9b1); 

E:=EllipticCurve([a,b]);
print E;

//P:=Random(E);
P:=E![3055563715971644849423804859220265481316585815874058627244, 5301271154980119921208363180474818072856515133833450622956];
print "El punto P= ", P;
X1:=P[1];
Y1:=P[2];
Z1:=P[3];

//X1:=212301062088922360897718636909718509707927984535520031981505334286281088213279103583527720024622273014941745845926432958660220448002748878401956193718249114;
//Y1:=6818536214948665048512398719751378771718765228936247143232679847194284772046122091467555030419501845795443390686428227721728887718738006956709078369832346995;
//Z1:=1;
Q:=2*P;

alpha:= 3*(X1+Z1^2)*(X1-Z1^2);
beta:=4*X1*Y1^2;
print "jacobian";
X3:=alpha^2-2*beta;
print "X3=", X3;
Y3:=alpha*(beta-X3)-8*Y1^4;
print "Y3=", Y3;
Z3:=2*Y1*Z1;
print "Z3=",2*Y1*Z1;
print "affine";
print "X3/Z3^2=", X3/Z3^2;
print "Y3/Z3^3=", Y3/Z3^3;
print "Z3=", Z3/Z3;
print "";
print "El punto 2*P es=", Q;
